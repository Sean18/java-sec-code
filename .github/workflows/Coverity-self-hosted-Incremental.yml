
name: Run Coverity on Self-Hosted Agent INCREMENTAL
on: [push]

jobs:
  synopsys_coverity:
    name: Synopsys Coverity
    #runs-on: ubuntu-latest
    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    #- name: Build with Maven
    #  run: mvn -B package --file pom.xml

    # - name: Get Changed File List 
    #   run: |
    #     echo Getting files for changeset SHA:  $GITHUB_SHA
    #     git show $GITHUB_SHA --name-only --pretty=""

    - name: C-R-D Setup              
      run: |
        cov-run-desktop --setup --user admin --password SIGpass8!   
    
    - name: Run Incremental Analysis
      run: |
        cov-run-desktop --webapp-security --reference-snapshot latest --ignore-uncapturable-inputs true --scm git --analyze-scm-modified
    
        
    # - name: Cov-Commit-Defects
    #   run: |
    #     cov-commit-defects --dir idir --host 52.188.212.142 --stream java-sec-code --user admin --password SIGpass8!
